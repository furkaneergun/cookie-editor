function GenericCookieHandler(){"use strict";Event.call(this),this.cookies=[],this.currentTab=null;let t=new BrowserDetector;this.getAllCookies=function(e){t.isFirefox()&&t.isSafari()?t.getApi().cookies.getAll({url:this.currentTab.url,storeId:this.currentTab.cookieStoreId}).then(e,function(t){console.error("Failed to retrieve cookies",t)}):t.getApi().cookies.getAll({url:this.currentTab.url,storeId:this.currentTab.cookieStoreId},e)},this.saveCookie=function(e,i,r){let o={domain:e.domain||"",name:e.name||"",value:e.value||"",path:e.path||null,secure:e.secure||null,httpOnly:e.httpOnly||null,expirationDate:e.expirationDate||null,storeId:e.storeId||this.currentTab.cookieStoreId||null,url:i};t.isSafari()&&o.domain&&(o.url="http://"+o.domain),(e.hostOnly||t.isSafari()&&!o.domain)&&(o.domain=null),t.supportSameSiteCookie()&&!t.isSafari()&&(o.sameSite=e.sameSite||void 0,"no_restriction"==o.sameSite&&(o.secure=!0),t.isSafari()&&(o.sameSite="explicit")),t.isFirefox()||t.isSafari()?t.getApi().cookies.set(o).then((t,e,i,o)=>{r&&r(null,t)},t=>{console.error("Failed to create cookie",t),r&&r(t.message,null)}):t.getApi().cookies.set(o,e=>{let i=t.getApi().runtime.lastError;if(!e||i)return(console.error("Failed to create cookie",i),r)?r((i?i.message:"")||"Unknown error",e):void 0;if(r)return r(null,e)})},this.removeCookie=function(e,i,r,o=!1){t.isSafari()&&!o?this.getAllCookies(t=>{for(let o of t)if(o.name===e){let s=o.domain;s.includes("https://www.")?s=o.domain.replace("https://www.",""):s.includes("http://www.")&&(s=o.domain.replace("http://www.","")),s.includes("https://.")?s=o.domain.replace("https://.",""):s.includes("http://.")?s=o.domain.replace("http://.",""):s.includes("www.")&&(s=o.domain.replace("www.","")),"."==s.substring(0,1)&&(s=s.substring(1));let n=["http://"+s,"https://"+s,"http://."+s,"https://."+s,"http://www."+s,"https://www."+s],l=i;l.includes("https://www.")?l=l.replace("https://www.",""):l.includes("http://www.")&&(l=l.replace("http://www.","")),l.includes("https://.")?l=l.replace("https://.",""):l.includes("http://.")?l=l.replace("http://.",""):l.includes("www.")&&(l=l.replace("www.","")),"."==l.substring(0,1)&&(l=l.substring(1));let a=["http://"+l,"https://"+l,"http://."+l,"https://."+l,"http://www."+l,"https://www."+l],p=o.domain+o.path;l.includes("https://www.")?p=p.replace("https://www.",""):l.includes("http://www.")&&(p=p.replace("http://www.","")),l.includes("https://.")?p=p.replace("https://.",""):l.includes("http://.")?p=p.replace("http://.",""):l.includes("www.")&&(p=p.replace("www.","")),"."==l.substring(0,1)&&(p=p.substring(1));let w=["http://"+p,"https://"+p,"http://."+p,"https://."+p,"http://www."+p,"https://www."+p],c=[...new Set([...n,...a,...w])];for(let h of c)this.removeCookie(e,h,r,!0)}}):t.isFirefox()||t.isSafari()?t.getApi().cookies.remove({name:e,url:i,storeId:this.currentTab.cookieStoreId}).then(r,function(t){console.error("Failed to remove cookies",t),r&&r()}):t.getApi().cookies.remove({name:e,url:i,storeId:this.currentTab.cookieStoreId},e=>{let i=t.getApi().runtime.lastError;if(!e||i)return(console.error("Failed to remove cookie",i),r)?r((i?i.message:"")||"Unknown error",e):void 0;if(r)return r(null,e)})}}